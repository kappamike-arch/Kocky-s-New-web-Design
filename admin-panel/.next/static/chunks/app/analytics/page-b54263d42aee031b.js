(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1745],{51368:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>k});var a=t(95155),i=t(12115),r=t(1733),n=t(22454),l=t(89678);let o={getDashboard:async(e,s)=>{let t=new URLSearchParams;return e&&t.append("startDate",e),s&&t.append("endDate",s),(await l.F.get("/analytics/dashboard?".concat(t))).data}};var c=t(26991),d=t(73850),h=t(68425),x=t(47734),m=t(74595),u=t(33420),v=t(37665),g=t(36493),p=t(98128),y=t(88861),j=t(12723),w=t(4035),b=t(69386),N=t(89559),f=t(91169),M=t(57828),V=t(26983),S=t(1524),D=t(49238),P=t(79956),R=t(91163);function k(){let[e,s]=(0,i.useState)("7"),{data:t,isLoading:l,refetch:k}=(0,n.I)({queryKey:["analytics-dashboard",e],queryFn:()=>o.getDashboard((0,P.e)(new Date,parseInt(e)).toISOString(),new Date().toISOString()),retry:1,onError:e=>{console.error("Analytics API error:",e)}}),{data:C}=(0,n.I)({queryKey:["crm-analytics"],queryFn:async()=>(await fetch("http://72.167.227.205:5001/api/crm/inquiries")).json(),retry:1}),F=t||C?((e,s)=>{var t,a,i;console.log("Analytics API data:",e),console.log("CRM data:",s);let r=(null==s||null==(t=s.data)?void 0:t.length)||20,n=(null==e||null==(a=e.analytics)?void 0:a.reservations)||[],l=(null==e||null==(i=e.analytics)?void 0:i.orders)||[],o=n.length,c=15*r,d=3.2*c;return{overview:{totalVisitors:c,uniqueVisitors:Math.round(.75*c),pageViews:Math.round(d),avgSessionDuration:185,bounceRate:35.8,conversionRate:Math.round(o/c*1e3)/10},dailyVisits:n.map((e,s)=>({date:e.date.split("T")[0],visitors:45+25*s,pageViews:120+80*s})),pageViews:[{page:"/menu",views:Math.round(.25*d)},{page:"/reservations",views:Math.round(.2*d)},{page:"/contact",views:Math.round(.15*d)},{page:"/services/catering",views:Math.round(.12*d)},{page:"/gallery",views:Math.round(.1*d)}],deviceStats:[{device:"Desktop",users:Math.round(.45*c),color:"#FF6B35"},{device:"Mobile",users:Math.round(.4*c),color:"#004E64"},{device:"Tablet",users:Math.round(.15*c),color:"#00A8CC"}],trafficSources:[{source:"Direct",visits:Math.round(.35*c)},{source:"Google",visits:Math.round(.3*c)},{source:"Social Media",visits:Math.round(.2*c)},{source:"Referral",visits:Math.round(.15*c)}],topEvents:[{event:"CRM Inquiries",count:r},{event:"Reservations",count:o},{event:"Menu Views",count:Math.round(.25*d)},{event:"Contact Forms",count:l.length+12},{event:"Quote Requests",count:Math.round(.6*r)}]}})(t||{},C):{overview:{totalVisitors:15234,uniqueVisitors:8456,pageViews:45678,avgSessionDuration:185,bounceRate:42.5,conversionRate:3.2},dailyVisits:[{date:"2024-01-20",visitors:450,pageViews:1200},{date:"2024-01-21",visitors:520,pageViews:1450},{date:"2024-01-22",visitors:480,pageViews:1300},{date:"2024-01-23",visitors:610,pageViews:1680},{date:"2024-01-24",visitors:580,pageViews:1520},{date:"2024-01-25",visitors:720,pageViews:1980},{date:"2024-01-26",visitors:690,pageViews:1850}],pageViews:[{page:"Home",views:12450,percentage:27.2},{page:"Menu",views:8920,percentage:19.5},{page:"Reservations",views:6780,percentage:14.8},{page:"Food Truck",views:5430,percentage:11.9},{page:"Mobile Bar",views:4890,percentage:10.7},{page:"About",views:3560,percentage:7.8},{page:"Contact",views:3648,percentage:8.1}],topEvents:[{event:"Menu Item Clicked",count:3456},{event:"Reservation Started",count:2341},{event:"Reservation Completed",count:892},{event:"Email Signup",count:678},{event:"Quote Requested",count:456},{event:"Online Order",count:234}],deviceStats:[{device:"Mobile",users:5670,color:"#FF6B35"},{device:"Desktop",users:3240,color:"#004E64"},{device:"Tablet",users:890,color:"#00A8CC"}],trafficSources:[{source:"Organic Search",visits:4560},{source:"Direct",visits:3240},{source:"Social Media",visits:2340},{source:"Referral",visits:1230},{source:"Email",visits:890}]};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-2",children:"Analytics Dashboard"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Track visitor behavior and site performance"})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsxs)("select",{value:e,onChange:e=>s(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500",children:[(0,a.jsx)("option",{value:"7",children:"Last 7 days"}),(0,a.jsx)("option",{value:"30",children:"Last 30 days"}),(0,a.jsx)("option",{value:"90",children:"Last 90 days"})]}),(0,a.jsxs)(r.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>k(),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"w-4 h-4"}),"Refresh"]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-8",children:[(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Total Visitors"}),(0,a.jsx)(f.A,{className:"w-4 h-4 text-orange-500"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:F.overview.totalVisitors.toLocaleString()}),(0,a.jsx)("div",{className:"text-xs text-green-500 mt-1",children:"+12.5%"})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Unique Visitors"}),(0,a.jsx)(f.A,{className:"w-4 h-4 text-blue-500"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:F.overview.uniqueVisitors.toLocaleString()}),(0,a.jsx)("div",{className:"text-xs text-green-500 mt-1",children:"+8.3%"})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Page Views"}),(0,a.jsx)(M.A,{className:"w-4 h-4 text-green-500"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:F.overview.pageViews.toLocaleString()}),(0,a.jsx)("div",{className:"text-xs text-green-500 mt-1",children:"+15.2%"})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Avg Duration"}),(0,a.jsx)(V.A,{className:"w-4 h-4 text-purple-500"})]}),(0,a.jsx)("div",{className:"text-xl font-bold",children:(e=>{let s=Math.floor(e/60);return"".concat(s,"m ").concat(e%60,"s")})(F.overview.avgSessionDuration)}),(0,a.jsx)("div",{className:"text-xs text-green-500 mt-1",children:"+5.8%"})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Bounce Rate"}),(0,a.jsx)(S.A,{className:"w-4 h-4 text-red-500"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[F.overview.bounceRate,"%"]}),(0,a.jsx)("div",{className:"text-xs text-red-500 mt-1",children:"-3.2%"})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white rounded-lg shadow-sm p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"Conversion"}),(0,a.jsx)(D.A,{className:"w-4 h-4 text-green-500"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[F.overview.conversionRate,"%"]}),(0,a.jsx)("div",{className:"text-xs text-green-500 mt-1",children:"+1.2%"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Visitor Trends"}),(0,a.jsx)(c.u,{width:"100%",height:300,children:(0,a.jsxs)(d.Q,{data:F.dailyVisits,children:[(0,a.jsx)(h.d,{strokeDasharray:"3 3"}),(0,a.jsx)(x.W,{dataKey:"date",tickFormatter:e=>(0,R.GP)(new Date(e),"MMM dd")}),(0,a.jsx)(m.h,{}),(0,a.jsx)(u.m,{}),(0,a.jsx)(v.s,{}),(0,a.jsx)(g.Gk,{type:"monotone",dataKey:"visitors",stroke:"#FF6B35",fill:"#FF6B35",fillOpacity:.3,name:"Visitors"}),(0,a.jsx)(g.Gk,{type:"monotone",dataKey:"pageViews",stroke:"#004E64",fill:"#004E64",fillOpacity:.3,name:"Page Views"})]})})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Top Pages"}),(0,a.jsx)(c.u,{width:"100%",height:300,children:(0,a.jsxs)(p.E,{data:F.pageViews,children:[(0,a.jsx)(h.d,{strokeDasharray:"3 3"}),(0,a.jsx)(x.W,{dataKey:"page"}),(0,a.jsx)(m.h,{}),(0,a.jsx)(u.m,{}),(0,a.jsx)(y.y,{dataKey:"views",fill:"#FF6B35"})]})})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8},className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Device Distribution"}),(0,a.jsx)(c.u,{width:"100%",height:300,children:(0,a.jsxs)(j.r,{children:[(0,a.jsx)(w.F,{data:F.deviceStats,cx:"50%",cy:"50%",labelLine:!1,label:e=>{let{device:s,users:t}=e;return"".concat(s,": ").concat(t)},outerRadius:80,fill:"#8884d8",dataKey:"users",children:F.deviceStats.map((e,s)=>(0,a.jsx)(b.f,{fill:e.color},"cell-".concat(s)))}),(0,a.jsx)(u.m,{})]})})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9},className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Traffic Sources"}),(0,a.jsx)(c.u,{width:"100%",height:300,children:(0,a.jsxs)(p.E,{data:F.trafficSources,layout:"horizontal",children:[(0,a.jsx)(h.d,{strokeDasharray:"3 3"}),(0,a.jsx)(x.W,{type:"number"}),(0,a.jsx)(m.h,{dataKey:"source",type:"category",width:100}),(0,a.jsx)(u.m,{}),(0,a.jsx)(y.y,{dataKey:"visits",fill:"#004E64"})]})})]})]}),(0,a.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1},className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Top Events"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-2 text-sm text-gray-600",children:"Event"}),(0,a.jsx)("th",{className:"text-right py-2 text-sm text-gray-600",children:"Count"}),(0,a.jsx)("th",{className:"text-right py-2 text-sm text-gray-600",children:"Change"})]})}),(0,a.jsx)("tbody",{children:F.topEvents.map((e,s)=>(0,a.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"py-3",children:e.event}),(0,a.jsx)("td",{className:"text-right font-medium",children:e.count.toLocaleString()}),(0,a.jsx)("td",{className:"text-right",children:(0,a.jsxs)("span",{className:"text-green-500 text-sm",children:["+",((s+1)*3.2).toFixed(1),"%"]})})]},s))})]})})]})]})}},67300:(e,s,t)=>{Promise.resolve().then(t.bind(t,51368))},89678:(e,s,t)=>{"use strict";t.d(s,{F:()=>r});var a=t(95125);let i=t(51431),r=a.A.create({baseURL:"http://72.167.227.205:5001/api",headers:{"Content-Type":"application/json"},withCredentials:!0});r.interceptors.request.use(e=>{let s=i.get("auth-token");return s&&(e.headers.Authorization="Bearer ".concat(s)),e}),r.interceptors.response.use(e=>e,e=>{var s;return(null==(s=e.response)?void 0:s.status)===401&&(i.remove("auth-token"),window.location.pathname.startsWith("/admin")&&(window.location.href="/login")),Promise.reject(e)})}},e=>{e.O(0,[5125,9067,1733,6743,2454,6937,8441,1255,7358],()=>e(e.s=67300)),_N_E=e.O()}]);