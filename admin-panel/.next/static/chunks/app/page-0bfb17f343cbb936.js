(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{14511:(e,t,r)=>{Promise.resolve().then(r.bind(r,89547))},20063:(e,t,r)=>{"use strict";var s=r(47260);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},51431:function(e){e.exports=function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var s in r)e[s]=r[s]}return e}return function t(r,s){function a(t,a,n){if("undefined"!=typeof document){"number"==typeof(n=e({},s,n)).expires&&(n.expires=new Date(Date.now()+864e5*n.expires)),n.expires&&(n.expires=n.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var o="";for(var i in n)n[i]&&(o+="; "+i,!0!==n[i]&&(o+="="+n[i].split(";")[0]));return document.cookie=t+"="+r.write(a,t)+o}}return Object.create({set:a,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],s={},a=0;a<t.length;a++){var n=t[a].split("="),o=n.slice(1).join("=");try{var i=decodeURIComponent(n[0]);if(s[i]=r.read(o,i),e===i)break}catch(e){}}return e?s[e]:s}},remove:function(t,r){a(t,"",e({},r,{expires:-1}))},withAttributes:function(r){return t(this.converter,e({},this.attributes,r))},withConverter:function(r){return t(e({},this.converter,r),this.attributes)}},{attributes:{value:Object.freeze(s)},converter:{value:Object.freeze(r)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}()},63119:(e,t,r)=>{"use strict";r.d(t,{j:()=>n});var s=r(89678);let a=r(51431),n={login:async e=>{let t=await s.F.post("/auth/login",e);return t.data.token&&a.set("auth-token",t.data.token,{expires:7}),t.data.refreshToken&&a.set("refresh-token",t.data.refreshToken,{expires:30}),t.data.user&&(localStorage.setItem("user",JSON.stringify(t.data.user)),localStorage.setItem("user-id",t.data.user.id)),t.data},register:async e=>(await s.F.post("/auth/register",e)).data,logout:async()=>{try{await s.F.post("/auth/logout")}finally{a.remove("auth-token"),a.remove("refresh-token"),localStorage.removeItem("user"),localStorage.removeItem("user-id")}},getProfile:async()=>(await s.F.get("/auth/profile")).data,refreshToken:async()=>{let e=a.get("refresh-token");if(!e)throw Error("No refresh token");let t=await s.F.post("/auth/refresh",{refreshToken:e});return t.data.token&&a.set("auth-token",t.data.token,{expires:7}),t.data},isAuthenticated:()=>{let e=a.get("auth-token"),t=!!e;return console.log("\uD83D\uDD0D Auth Check:",{hasToken:t,tokenLength:null==e?void 0:e.length}),t},getCurrentUser:()=>{let e=localStorage.getItem("user");return e?JSON.parse(e):null},hasRole:e=>{let t=n.getCurrentUser();return(null==t?void 0:t.role)===e},isAdmin:()=>n.hasRole("ADMIN"),isStaff:()=>n.hasRole("STAFF")||n.hasRole("ADMIN")}},89547:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var s=r(95155),a=r(12115),n=r(20063),o=r(63119),i=r(22663);function l(){let[e,t]=(0,a.useState)(""),[r,l]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),[h,g]=(0,a.useState)(!1),[p,f]=(0,a.useState)(!1),x=(0,n.useRouter)();(0,a.useEffect)(()=>{f(!0)},[]),(0,a.useEffect)(()=>{p&&(console.log("\uD83D\uDD0D Login Page: Checking authentication..."),o.j.isAuthenticated()?(console.log("✅ Login Page: User is authenticated, redirecting..."),g(!0),window.location.href="/dashboard"):console.log("❌ Login Page: User not authenticated, showing login form"))},[p,x]);let v=async t=>{t.preventDefault(),m(!0),c("");try{let t=await o.j.login({email:e,password:r});if(console.log("Login response:",t),t.success&&t.user){let e=t.user.role;console.log("User role:",e),"ADMIN"===e||"SUPER_ADMIN"===e||"STAFF"===e?(i.Ay.success("Login successful!"),console.log("Redirecting to dashboard..."),g(!0),window.location.href="/dashboard"):(c("Access denied. Admin privileges required."),await o.j.logout())}else c("Invalid credentials. Please try again.")}catch(e){var s,a,n;console.error("Login error:",e),(null==(s=e.response)?void 0:s.status)===401?c("Invalid email or password."):(null==(a=e.response)?void 0:a.status)===403?c("Access denied. Admin privileges required."):(null==(n=e.message)?void 0:n.includes("Network"))?c("Network error. Please check your connection."):c("Login failed. Please try again later.")}finally{m(!1)}};return!p||h?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-white text-lg",children:h?"Loading dashboard...":"Initializing..."})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-900 to-gray-800",children:(0,s.jsx)("div",{className:"max-w-md w-full",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl p-8",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Portal"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Kocky's Bar & Grill Management System"}),(0,s.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md",children:(0,s.jsx)("p",{className:"text-sm text-yellow-800",children:"⚠️ This is a secure area. Unauthorized access attempts are monitored and will be prosecuted."})})]}),(0,s.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[d&&(0,s.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,s.jsx)("p",{className:"text-sm text-red-600",children:d})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Admin Email"}),(0,s.jsx)("input",{id:"email",type:"email",value:e,onChange:e=>t(e.target.value),className:"admin-input",placeholder:"admin@kockysbar.com",required:!0})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,s.jsx)("input",{id:"password",type:"password",value:r,onChange:e=>l(e.target.value),className:"admin-input",placeholder:"Enter secure password",required:!0})]}),(0,s.jsx)("button",{type:"submit",disabled:u,className:"w-full py-3 bg-admin-primary text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",children:u?"Authenticating...":"Secure Login"})]}),(0,s.jsxs)("div",{className:"mt-6 text-center text-sm text-gray-500",children:[(0,s.jsx)("p",{children:"Admin Portal URL: https://staging.kockys.com/admin"}),(0,s.jsx)("p",{className:"mt-2",children:"For security issues, contact IT support"})]}),(0,s.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-md border border-gray-200",children:[(0,s.jsx)("p",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Test Credentials:"}),(0,s.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Super Admin:"})," admin@kockysbar.com / AdminPassword123!"]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-medium",children:"Manager:"})," manager@kockysbar.com / ManagerPassword123!"]})]})]})]})})})}},89678:(e,t,r)=>{"use strict";r.d(t,{F:()=>n});var s=r(95125);let a=r(51431),n=s.A.create({baseURL:"http://72.167.227.205:5001/api",headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>{let t=a.get("auth-token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),n.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(a.remove("auth-token"),window.location.pathname.startsWith("/admin")&&(window.location.href="/login")),Promise.reject(e)})}},e=>{e.O(0,[2663,5125,8441,1255,7358],()=>e(e.s=14511)),_N_E=e.O()}]);