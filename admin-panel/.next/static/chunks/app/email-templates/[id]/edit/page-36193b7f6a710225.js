(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1836],{20063:(e,t,a)=>{"use strict";var s=a(47260);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}})},35626:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},42196:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},45105:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});var s=a(12115),l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let r=(e,t)=>{let a=(0,s.forwardRef)((a,r)=>{let{color:n="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:m="",children:d,...u}=a;return(0,s.createElement)("svg",{ref:r,...l,width:o,height:o,stroke:n,strokeWidth:c?24*Number(i)/Number(o):i,className:["lucide","lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()),m].join(" "),...u},[...t.map(e=>{let[t,a]=e;return(0,s.createElement)(t,a)}),...Array.isArray(d)?d:[d]])});return a.displayName="".concat(e),a}},46046:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},47228:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>g});var s=a(95155),l=a(12115),r=a(20063),n=a(35626),o=a(57828),i=a(46046);let c=(0,a(45105).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);var m=a(89715),d=a(42196),u=a(91761),p=a(22663),h=a(52619),x=a.n(h);function g(){let e=(0,r.useParams)(),t=(0,r.useRouter)(),a=e.id,[h,g]=(0,l.useState)(null),[y,f]=(0,l.useState)(!0),[b,v]=(0,l.useState)(!1),[j,N]=(0,l.useState)(!1),[k,w]=(0,l.useState)(""),[C,A]=(0,l.useState)("html");(0,l.useEffect)(()=>{a&&"new"!==a?T():(g({id:"",name:"",subject:"",htmlContent:"",textContent:"",variables:[],logoUrl:"/api/uploads/logos/kockys-logo.png",footerText:"Kocky's Bar & Grill | 123 Main Street | (555) 123-4567",paymentLink:"",isActive:!0}),f(!1))},[a]);let T=async()=>{try{let e=await fetch("/api/email-templates/".concat(a));if(e.ok){let t=await e.json();g(t.template)}else p.default.error("Template not found"),t.push("/email-templates")}catch(e){console.error("Error fetching template:",e),p.default.error("Failed to load template")}finally{f(!1)}},S=async()=>{if(h){v(!0);try{(await fetch("new"===a?"/api/email-templates":"/api/email-templates/".concat(a),{method:"new"===a?"POST":"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(h)})).ok?(p.default.success("Template saved successfully"),t.push("/email-templates")):p.default.error("Failed to save template")}catch(e){console.error("Error saving template:",e),p.default.error("Failed to save template")}finally{v(!1)}}},L=async()=>{if(h)try{let e=await fetch("/api/email-templates/".concat(a,"/preview"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sampleData:{customerName:"John Doe",customerEmail:"john@example.com",serviceName:"Mobile Bar Service",eventDate:new Date().toLocaleDateString(),eventLocation:"123 Main Street, City",guestCount:"100",confirmationCode:"ABC123",quoteNumber:"Q-2024-0001",totalAmount:"$2,500",validUntil:new Date(Date.now()+2592e6).toLocaleDateString(),paymentLink:h.paymentLink||"https://payment.kockys.com/pay/ABC123",logoUrl:h.logoUrl,footerText:h.footerText}})});if(e.ok){let t=await e.json();w(t.preview.html),N(!0)}}catch(a){console.error("Error previewing template:",a);let e={customerName:"John Doe",customerEmail:"john@example.com",serviceName:"Mobile Bar Service",eventDate:new Date().toLocaleDateString(),eventLocation:"123 Main Street, City",guestCount:"100",confirmationCode:"ABC123",quoteNumber:"Q-2024-0001",totalAmount:"$2,500",paymentLink:h.paymentLink||"https://payment.kockys.com/pay/ABC123",logoUrl:h.logoUrl,footerText:h.footerText},t=h.htmlContent;Object.entries(e).forEach(e=>{let[a,s]=e;t=t.replace(RegExp("{{".concat(a,"}}"),"g"),s)}),w(t),N(!0)}};return y?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):h?(0,s.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)(x(),{href:"/email-templates",className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,s.jsx)(n.A,{className:"w-5 h-5"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"new"===a?"Create Email Template":"Edit Email Template"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Customize your automated email template"})]})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:L,className:"px-4 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[(0,s.jsx)(o.A,{className:"w-4 h-4"}),"Preview"]}),(0,s.jsxs)("button",{onClick:S,disabled:b,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark flex items-center gap-2 disabled:opacity-50",children:[(0,s.jsx)(i.A,{className:"w-4 h-4"}),b?"Saving...":"Save Template"]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Template Information"}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Template Name"}),(0,s.jsx)("input",{type:"text",value:h.name,onChange:e=>g({...h,name:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary",placeholder:"e.g., inquiry_confirmation"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Email Subject"}),(0,s.jsx)("input",{type:"text",value:h.subject,onChange:e=>g({...h,subject:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary",placeholder:"e.g., Thank you for contacting {{customerName}}!"})]})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Template Content"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>A("html"),className:"px-3 py-1 rounded ".concat("html"===C?"bg-primary text-white":"bg-gray-100"),children:[(0,s.jsx)(c,{className:"w-4 h-4 inline mr-1"})," HTML"]}),(0,s.jsxs)("button",{onClick:()=>A("text"),className:"px-3 py-1 rounded ".concat("text"===C?"bg-primary text-white":"bg-gray-100"),children:[(0,s.jsx)(m.A,{className:"w-4 h-4 inline mr-1"})," Text"]}),(0,s.jsx)("button",{onClick:()=>A("settings"),className:"px-3 py-1 rounded ".concat("settings"===C?"bg-primary text-white":"bg-gray-100"),children:"Settings"})]})]}),"html"===C&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Available Variables (click to insert):"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["customerName","customerEmail","serviceName","eventDate","eventLocation","guestCount","confirmationCode","quoteNumber","totalAmount","validUntil","paymentLink","logoUrl","footerText"].map(e=>(0,s.jsx)("button",{onClick:()=>(e=>{var t;if(!h)return;let a=(null==(t=document.getElementById("htmlContent"))?void 0:t.selectionStart)||0,s=h.htmlContent.slice(0,a)+"{{".concat(e,"}}")+h.htmlContent.slice(a);g({...h,htmlContent:s})})(e),className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200",children:"{{".concat(e,"}}")},e))})]}),(0,s.jsx)("textarea",{id:"htmlContent",value:h.htmlContent,onChange:e=>g({...h,htmlContent:e.target.value}),className:"w-full h-96 px-3 py-2 border rounded-lg font-mono text-sm focus:ring-2 focus:ring-primary",placeholder:"Enter HTML content..."})]}),"text"===C&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Plain text version (optional):"}),(0,s.jsx)("textarea",{value:h.textContent||"",onChange:e=>g({...h,textContent:e.target.value}),className:"w-full h-96 px-3 py-2 border rounded-lg font-mono text-sm focus:ring-2 focus:ring-primary",placeholder:"Enter plain text content..."})]}),"settings"===C&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[(0,s.jsx)(d.A,{className:"w-4 h-4 inline mr-1"})," Logo URL"]}),(0,s.jsx)("input",{type:"text",value:h.logoUrl||"",onChange:e=>g({...h,logoUrl:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary",placeholder:"/api/uploads/logos/kockys-logo.png"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Footer Text"}),(0,s.jsx)("input",{type:"text",value:h.footerText||"",onChange:e=>g({...h,footerText:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary",placeholder:"Kocky's Bar & Grill | 123 Main St | (555) 123-4567"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium mb-2",children:[(0,s.jsx)(u.A,{className:"w-4 h-4 inline mr-1"})," Payment Link Template"]}),(0,s.jsx)("input",{type:"text",value:h.paymentLink||"",onChange:e=>g({...h,paymentLink:e.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-primary",placeholder:"https://payment.kockys.com/pay/{{quoteNumber}}"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Use ","{{quoteNumber}}"," or ","{{confirmationCode}}"," as variables in the URL"]})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"flex items-center gap-2",children:[(0,s.jsx)("input",{type:"checkbox",checked:h.isActive,onChange:e=>g({...h,isActive:e.target.checked}),className:"rounded"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Template is Active"})]})})]})]}),j&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Email Preview"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:["Subject: ",h.subject.replace(/{{[^}]+}}/g,e=>({customerName:"John Doe",quoteNumber:"Q-2024-0001"})[e.slice(2,-2)]||e)]})]}),(0,s.jsx)("button",{onClick:()=>N(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"✕"})]}),(0,s.jsx)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsx)("iframe",{srcDoc:k,className:"w-full h-[600px]",title:"Email Preview"})})})]})})]}):(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)("div",{className:"bg-red-50 text-red-800 p-4 rounded-lg",children:"Template not found"})})}},57828:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},89715:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},91761:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},99645:(e,t,a)=>{Promise.resolve().then(a.bind(a,47228))}},e=>{e.O(0,[2663,2619,8441,1255,7358],()=>e(e.s=99645)),_N_E=e.O()}]);