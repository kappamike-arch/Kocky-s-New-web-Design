(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4463],{5917:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6191:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},11010:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]])},23664:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},33794:(e,t,a)=>{Promise.resolve().then(a.bind(a,82114))},42196:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]])},57828:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},76329:(e,t,a)=>{"use strict";a.d(t,{H$:()=>r});var s=a(95704);let l=("staging"===s.env.NEXT_PUBLIC_ENV,"http://staging.kockys.com"),r="".concat(l,"/api");console.log("\uD83D\uDD27 API Configuration:"),console.log("  Environment:","production"),console.log("  Custom ENV:",s.env.NEXT_PUBLIC_ENV),console.log("  API Base URL:",l),console.log("  Full API URL:",r)},82114:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>v});var s=a(95155),l=a(12115),r=a(1733),i=a(23664),n=a(89715),o=a(91761),c=a(6191),m=a(5917),d=a(42196),h=a(57828),u=a(11010),p=a(22663),x=a(52619),g=a.n(x),y=a(89678);function v(){let[e,t]=(0,l.useState)([]),[a,x]=(0,l.useState)(!0),[v,b]=(0,l.useState)(null),[f,j]=(0,l.useState)(!1),[N,w]=(0,l.useState)(!1),[k,A]=(0,l.useState)("");(0,l.useEffect)(()=>{C(),T()},[]);let C=async()=>{var e,a;try{console.log("\uD83D\uDD0D fetchTemplates: Starting API call...");let a=await y.F.get("/email-templates");console.log("\uD83D\uDD0D fetchTemplates: API response:",a.data);let s=(null==(e=a.data)?void 0:e.templates)||[];console.log("\uD83D\uDD0D fetchTemplates: Templates extracted:",s),t(s)}catch(e){console.error("\uD83D\uDD0D fetchTemplates: Error occurred:",e),console.error("\uD83D\uDD0D fetchTemplates: Error response:",null==(a=e.response)?void 0:a.data),t([{id:"mock-inquiry",name:"Inquiry Confirmation",subject:"Thanks for your inquiry — we got it!",htmlContent:"<h1>Thank you for your inquiry!</h1>",variables:["customerName","serviceName"],isActive:!0},{id:"mock-quote",name:"Quote Request Confirmation",subject:"Your quote from Kocky's (##{{quoteNumber}})",htmlContent:"<h1>Your quote is ready!</h1>",variables:["customerName","quoteNumber","totalAmount"],isActive:!0},{id:"mock-mobile-bar",name:"Mobile Bar Booking Confirmation",subject:"Mobile Bar booking received",htmlContent:"<h1>Your Mobile Bar booking is confirmed!</h1>",variables:["customerName","eventDate","eventTime","eventLocation"],isActive:!0}])}finally{x(!1)}},T=async()=>{try{console.log("\uD83D\uDD0D initializeDefaultTemplates: Starting...");let e=await y.F.post("/email-templates/initialize");console.log("\uD83D\uDD0D initializeDefaultTemplates: Response:",e.data),e.data&&e.data.templates&&e.data.templates.length>0&&(p.Ay.success("Initialized ".concat(e.data.templates.length," default templates")),C())}catch(t){var e;console.error("\uD83D\uDD0D initializeDefaultTemplates: Error occurred:",t),console.error("\uD83D\uDD0D initializeDefaultTemplates: Error response:",null==(e=t.response)?void 0:e.data),p.Ay.error("Failed to initialize templates")}},q=async e=>{try{let t=await y.F.post("/email-templates/".concat(e.id,"/preview"),{sampleData:{customerName:"John Doe",customerEmail:"john@example.com",serviceName:"Mobile Bar Service",eventDate:new Date().toLocaleDateString(),eventLocation:"123 Main Street, City",guestCount:"100",confirmationCode:"ABC123",quoteNumber:"Q-2024-0001",totalAmount:"$2,500",validUntil:new Date(Date.now()+2592e6).toLocaleDateString(),paymentLink:"https://payment.kockys.com/pay/ABC123",logoUrl:e.logoUrl||"/api/uploads/logos/kockys-logo.png",footerText:e.footerText||"Kocky's Bar & Grill | 123 Main St | (555) 123-4567"}});A(t.data.preview.html),w(!0),b(e)}catch(e){console.error("Error previewing template:",e),p.Ay.error("Failed to preview template")}};return(0,s.jsxs)("div",{className:"p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Email Templates"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Manage and customize automated email templates"})]}),(0,s.jsxs)(g(),{href:"/email-templates/new",className:"bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"w-5 h-5"}),"New Template"]})]}),(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(i.A,{className:"w-6 h-6 text-blue-600 mt-1"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-blue-900",children:"Office 365 Email Configuration"}),(0,s.jsx)("p",{className:"text-blue-700 text-sm mt-1",children:"Emails are sent through your Microsoft Office 365 account (via GoDaddy)."}),(0,s.jsxs)("p",{className:"text-blue-600 text-sm mt-2",children:[(0,s.jsx)("strong",{children:"Current Settings:"})," SMTP Host: smtp.office365.com | Port: 587 | From: info@kockys.com"]})]})]})}),(0,s.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:a?(0,s.jsx)("div",{className:"col-span-full text-center py-12",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"})}):0===e.length?(0,s.jsxs)("div",{className:"col-span-full text-center py-12",children:[(0,s.jsx)(i.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"No email templates found"}),(0,s.jsx)("button",{onClick:T,className:"mt-4 px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark",children:"Initialize Default Templates"})]}):e.map(e=>{var t;return(0,s.jsxs)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm hover:shadow-lg transition-shadow p-6",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(t=e.name).includes("confirmation")?(0,s.jsx)(i.A,{className:"w-5 h-5"}):t.includes("quote")?(0,s.jsx)(n.A,{className:"w-5 h-5"}):t.includes("payment")?(0,s.jsx)(o.A,{className:"w-5 h-5"}):(0,s.jsx)(i.A,{className:"w-5 h-5"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold capitalize",children:e.name.replace(/_/g," ")}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.isActive?"Active":"Inactive"})]})]}),e.isActive&&(0,s.jsx)(m.A,{className:"w-5 h-5 text-green-500"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-4 line-clamp-2",children:e.subject}),(0,s.jsxs)("div",{className:"flex gap-2 mb-4",children:[e.logoUrl&&(0,s.jsxs)("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded flex items-center gap-1",children:[(0,s.jsx)(d.A,{className:"w-3 h-3"})," Logo"]}),e.paymentLink&&(0,s.jsxs)("span",{className:"text-xs bg-green-100 px-2 py-1 rounded flex items-center gap-1",children:[(0,s.jsx)(o.A,{className:"w-3 h-3"})," Payment"]}),e.textContent&&(0,s.jsxs)("span",{className:"text-xs bg-blue-100 px-2 py-1 rounded flex items-center gap-1",children:[(0,s.jsx)(n.A,{className:"w-3 h-3"})," Text"]})]}),e.variables&&e.variables.length>0&&(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1",children:"Variables:"}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-1",children:[e.variables.slice(0,3).map(e=>(0,s.jsx)("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded",children:"{{".concat(e,"}}")},e)),e.variables.length>3&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["+",e.variables.length-3," more"]})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>q(e),className:"flex-1 px-3 py-2 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 flex items-center justify-center gap-1",children:[(0,s.jsx)(h.A,{className:"w-4 h-4"}),"Preview"]}),(0,s.jsxs)(g(),{href:"/email-studio/".concat((e=>{let t=e.name.toLowerCase();return t.includes("inquiry")||t.includes("confirmation")?"inquiry":t.includes("quote")?"quote":t.includes("mobile")||t.includes("bar")?"mobileBar":"inquiry"})(e)),className:"flex-1 px-3 py-2 bg-primary text-white rounded hover:bg-primary-dark flex items-center justify-center gap-1",children:[(0,s.jsx)(u.A,{className:"w-4 h-4"}),"Edit"]})]})]},e.id)})}),N&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[(0,s.jsxs)("div",{className:"p-4 border-b flex items-center justify-between",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Template Preview"}),(0,s.jsx)("button",{onClick:()=>w(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,s.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[calc(90vh-120px)]",children:[v&&(0,s.jsx)("div",{className:"mb-4 p-3 bg-gray-50 rounded",children:(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,s.jsx)("strong",{children:"Subject:"})," ",v.subject]})}),(0,s.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,s.jsx)("iframe",{srcDoc:k,className:"w-full h-[600px]",title:"Email Preview"})})]})]})})]})}},89678:(e,t,a)=>{"use strict";a.d(t,{F:()=>n});var s=a(95125),l=a(76329),r=a(95704);let i=a(51431);r.env.NEXT_PUBLIC_CMS_URL;let n=s.A.create({baseURL:l.H$,headers:{"Content-Type":"application/json"},withCredentials:!0});n.interceptors.request.use(e=>{console.log("API Request:",e.baseURL+e.url);let t=i.get("auth-token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),n.interceptors.response.use(e=>e,e=>{var t;return(null==(t=e.response)?void 0:t.status)===401&&(i.remove("auth-token"),window.location.pathname.startsWith("/admin")&&(window.location.href="/login")),Promise.reject(e)})},89715:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},91761:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(45105).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])}},e=>{e.O(0,[5125,2663,3299,2619,8441,1255,7358],()=>e(e.s=33794)),_N_E=e.O()}]);